# ksp-practice

There are two main examples which I utilize KSP to generate code automatically.

## Data Store
- Utilize KSP to generate common logic of data store 
- Easy use in Activity and Fragment

### Usage :

````kotlin
@DefaultDataStoreFunction("appData", "App.Data", "App", "app_data.pb")
interface AppDataDefinition
````

### Generated by KSP :

````kotin
public val Context.appDataStore: DataStore<App.Data> by dataStore(
        fileName = "app_data.pb",
        serializer = AppSerializer
    )


public inline fun AppCompatActivity.appData(context: CoroutineContext = EmptyCoroutineContext,
    crossinline block: suspend (App.Data) -> Unit): Job = lifecycleScope.launch(context) {
        block(this@appData.appDataStore.data.first())
    }

public inline fun Fragment.appData(context: CoroutineContext = EmptyCoroutineContext, crossinline
    block: suspend (App.Data) -> Unit): Job = lifecycleScope.launch(context) {
        this@appData.context?.let { context ->
            block(context.appDataStore.data.first())
        }
    }
````

## View Binding in a Fragment
- Auto assign a view binding variable into a fragment
- Auto clear view binding during fragment invoke onDestroyView()

### Usage :

````kotlin
@AutoCompleteBindingFragment("FragmentDepositCodeBinding")
interface DepositCodeBindingFragment

// and implement the parent class
class DepositCodeFragment : DepositCodeBindingFragmentImpl() {
    // ...... your logic in a fragment
}
````

### Generate by KSP :

```kotlin
public open class DepositCodeBindingFragmentImpl : BaseFragment() {
  private var _binding: FragmentDepositCodeBinding? = null

  protected val binding: FragmentDepositCodeBinding?
    get() = _binding

  public override fun onCreateView(
    inflater: LayoutInflater,
    container: ViewGroup?,
    savedInstanceState: Bundle?
  ): View = FragmentDepositCodeBinding
          .inflate(inflater, container, false)
          .also { _binding = it }
          .root

  public override fun onDestroyView(): Unit {
    super.onDestroyView()
    _binding = null
  }
}
```
